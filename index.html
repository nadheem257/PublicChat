<!DOCTYPE html>
<html>
<head>
<title>Firebase Chat</title>
<style>
body { font-family: Arial; background:#111; color:white; padding:20px; }
#chatContainer { display:none; }
#loginContainer { display:block; }
input, button { width:100%; padding:10px; margin-top:10px; box-sizing:border-box; }
#messages { background:#000; height:300px; overflow-y:scroll; padding:10px; margin-top:10px; }
button { cursor:pointer; background:#222; color:white; border:none; }
button:disabled { background:#555; cursor:not-allowed; }
.message-you { color:#0f0; }
.message-friend { color:#0af; }
</style>
</head>
<body>

<div id="loginContainer">
  <h2>Enter Your Name</h2>
  <input id="nameInput" placeholder="Type your name...">
  <button id="enterBtn">Enter Chat</button>
</div>

<div id="chatContainer">
  <h2>Firebase Chat</h2>
  <div id="messages"></div>
  <input id="msg" placeholder="Type your message...">
  <button id="sendBtn">Send</button>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyCwSqm65CoNwPc3PiVo1T40YJM2MAcg480",
  authDomain: "server-1-9fa4f.firebaseapp.com",
  databaseURL: "https://server-1-9fa4f-default-rtdb.firebaseio.com",
  projectId: "server-1-9fa4f",
  storageBucket: "server-1-9fa4f.firebasestorage.app",
  messagingSenderId: "1019529146427",
  appId: "1:1019529146427:web:e22f6bbe1623b528f6ec1e"
};
firebase.initializeApp(firebaseConfig);

let db = firebase.database();
let room = "chat-room-1";
let messages = document.getElementById("messages");
let msgInput = document.getElementById("msg");
let sendBtn = document.getElementById("sendBtn");

let loginContainer = document.getElementById("loginContainer");
let chatContainer = document.getElementById("chatContainer");
let nameInput = document.getElementById("nameInput");
let enterBtn = document.getElementById("enterBtn");

let userName = "";
let userId = "user-" + Math.floor(Math.random()*100000);

// Function to add messages
function addMessage(text, cls) {
    messages.innerHTML += `<div class="${cls}">${text}</div>`;
    messages.scrollTop = messages.scrollHeight;
}

// Enter chat
enterBtn.addEventListener("click", () => {
    let name = nameInput.value.trim();
    if(!name) { alert("Please enter a name!"); return; }
    userName = name;
    loginContainer.style.display = "none";
    chatContainer.style.display = "block";
    addMessage(`Welcome ${userName}!`, "message-you");
});

// Send message
sendBtn.addEventListener("click", () => {
    let text = msgInput.value.trim();
    if(!text) return;
    db.ref(room).push({ text, user: userId, name: userName, time: Date.now() });
    msgInput.value = "";
});

// Listen for messages
db.ref(room).on("child_added", snap => {
    let data = snap.val();
    if(data && data.text){
        let cls = (data.user === userId) ? "message-you" : "message-friend";
        let displayName = (data.user === userId) ? "You" : data.name || "Friend";
        addMessage(`${displayName}: ${data.text}`, cls);
    }
});
</script>

</body>
</html>
