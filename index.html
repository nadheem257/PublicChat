<!DOCTYPE html>
<html>
<head>
<title>Firebase Chat</title>
<style>
body { font-family: Arial; background:#111; color:white; padding:20px;}
#msg { width:100%; padding:10px; margin-top:10px; box-sizing:border-box; }
#messages { background:#000; height:300px; overflow-y:scroll; padding:10px; margin-top:10px; }
button { width:100%; padding:10px; margin-top:10px; cursor:pointer; background:#222; color:white; border:none; }
button:disabled { background:#555; cursor:not-allowed; }
.message-you { color: #0f0; }
.message-friend { color: #0af; }
</style>
</head>
<body>

<h2>Firebase Chat</h2>
<input id="msg" placeholder="Type your message...">
<button id="sendBtn">Send</button>
<div id="messages"></div>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyCwSqm65CoNwPc3PiVo1T40YJM2MAcg480",
  authDomain: "server-1-9fa4f.firebaseapp.com",
  databaseURL: "https://server-1-9fa4f-default-rtdb.firebaseio.com",
  projectId: "server-1-9fa4f",
  storageBucket: "server-1-9fa4f.firebasestorage.app",
  messagingSenderId: "1019529146427",
  appId: "1:1019529146427:web:e22f6bbe1623b528f6ec1e"
};
firebase.initializeApp(firebaseConfig);

let db = firebase.database();
let room = "chat-room-1"; 
let messages = document.getElementById("messages");
let msgInput = document.getElementById("msg");
let sendBtn = document.getElementById("sendBtn");

// generate a random id for this user
let myId = 'user-' + Math.floor(Math.random()*100000);

// Send message
sendBtn.onclick = () => {
    let text = msgInput.value.trim();
    if(!text) return;
    db.ref(room).push({ text, user: myId, time: Date.now() });
    msgInput.value = "";
};

// Listen for messages
db.ref(room).on("child_added", snap => {
    let data = snap.val();
    if(data && data.text){
        let cls = (data.user === myId) ? 'message-you' : 'message-friend';
        messages.innerHTML += `<div class="${cls}">${(data.user === myId ? 'You' : 'Friend')}: ${data.text}</div>`;
        messages.scrollTop = messages.scrollHeight;
    }
});
</script>
</body>
</html>
